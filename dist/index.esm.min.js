var e="undefined"!=typeof window,t=e&&navigator.connection,n=e&&(!t||-1===(t.effectiveType||"").indexOf("2g")&&!t.saveData),r=e&&window.IntersectionObserver,o={};function i(e){return new Promise((function(t,n){var r=new XMLHttpRequest;r.open("GET",e,r.withCredentials=!0),r.addEventListener("load",(function(){200===r.status?t():n()})),r.send()}))}function u(e){return self.fetch?fetch(e,{credentials:"include"}):i(e)}var c=function(t){if(e){var n=document.createElement("link");return n.relList&&n.relList.supports&&n.relList.supports(t)}}("prefetch")?function(e){return new Promise((function(t,n){var r=document.createElement("link");r.rel="prefetch",r.href=e,r.addEventListener("load",t),r.addEventListener("error",n),document.head.appendChild(r)}))}:i;function s(e,t){if(n&&!o[e])return(t?u:c)(e).then((function(){o[e]=!0}))}function f(t,o){void 0===o&&(o={});var i=o.componentName;void 0===i&&(i="RouterLink");var u=o.prefetch;void 0===u&&(u=!0);var c=r&&new window.IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&e.target._linkPrefetch()}))})),f=e&&window.requestIdleCallback||function(e,t){var n=t.timeout;void 0===n&&(n=1);var r=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-r))}})}),n)},a=t.component("RouterLink")||t.component("router-link");"development"!==process.env.NODE_ENV||a||console.error("[vue-router-prefetch] You need to call app.use(VueRouter) before this plugin!");var h={name:i,extends:a,props:{prefetch:{type:Boolean,default:u},prefetchFiles:{type:Array},timeout:{type:Number,default:2e3}},setup:function(e,t){return a.setup(e,t)},mounted:function(){this.prefetch&&c&&n&&f(this.observe,{timeout:this.timeout})},beforeDestroy:function(){this.unobserve()},methods:{observe:function(){c.observe(this.$el),this.$el._linkPrefetch=this.linkPrefetch,this._linkObserved=!0},unobserve:function(){this._linkObserved&&c.unobserve(this.$el)},getRouteComponents:function(e){return e.matched.map((function(e){return Object.values(e.components)})).flat().filter((function(e){return void 0===e.cid&&"function"==typeof e}))},linkPrefetch:function(){var e=this.$router.resolve(this.to);if(!e.meta.__prefetched){if(e.meta.__prefetched=!0,!1!==e.meta.prefetch)for(var t=0,n=this.getRouteComponents(e);t<n.length;t+=1){var r=n[t];this.$emit("prefetch",this.to),r()}"function"==typeof e.meta.prefetch&&e.meta.prefetch(e);var o=(this.prefetchFiles||[]).concat(e.meta.prefetchFiles||[]);if(o.length>0)for(var i=0,u=o;i<u.length;i+=1){s(u[i])}this.unobserve()}}}};t.component(h.name,h)}export default f;export{f as install,s as prefetch};
//# sourceMappingURL=index.esm.min.js.map
